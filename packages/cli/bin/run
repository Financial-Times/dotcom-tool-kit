#!/usr/bin/env node

const { load, runTask } = require('../lib')
const c = require('ansi-colors')

const [task, ...argv] = process.argv.slice(2)

async function main() {
   try {
      await load()
      await runTask(task, argv)
   } catch(error) {
      if(error.details) {
         console.error(
            c.red.bold('‼︎') + ' ' +
            c.bold.underline(error.message) + '\n\n' +
            error.details
         )
      } else {
         console.error(error.stack)
      }

      process.exitCode = error.exitCode || 1
   }
}

main()
