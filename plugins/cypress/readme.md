# @dotcom-tool-kit/cypress

Tool Kit plugin to run [Cypress](https://www.cypress.io)

## Installation & usage

With Tool Kit [already set up](https://github.com/financial-times/dotcom-tool-kit#installing-and-using-tool-kit), install this plugin as a dev dependency:

```sh
npm install --save-dev @dotcom-tool-kit/cypress
```

And add it to your repo's `.toolkitrc.yml`:

```yml
plugins:
  - '@dotcom-tool-kit/cypress'
```

### Testing with Cypress locally

> [!IMPORTANT]
> Please check this documentation and make sure it's up to date with the way the Cypress plugin works now.

For local development, by default the `CypressLocal` task runs on the `e2e:local` command. This command is also defined within the `cypress` plugin and will install itself into your `package.json` config as the script `e2e-local`. Therefore, to run Cypress on a local instance of your project you just need to call `npm run e2e-local`. Note that, by default, this task does __not__ run your application for you, so if that's controlled by Tool Kit it's recommended you add its task to the `e2e:local` command too. For example, your config could look like:

```yml
plugins:
  - '@dotcom-tool-kit/cypress'
  - '@dotcom-tool-kit/node'

command:
  'e2e:local':
    - Node
    - Cypress
```

### Testing with Cypress on CI

The `CypressCI` task runs on the `test:review` and `test:staging` commands by default. These will run your Cypress end-to-end tests against the currently deployed review or staging app respectively.

### Running on another command
You can also configure Cypress to run on any other command; for example, if you want to run it with `npm run test` via the `npm` plugin, you can manually configure Cypress to run on `npm`'s `test:local` command:

```yml
plugins:
  - '@dotcom-tool-kit/cypress'
  - '@dotcom-tool-kit/node'
  - '@dotcom-tool-kit/npm'

command:
  'test:local':
    - Node
    - Cypress
```
<!-- begin autogenerated docs -->
## Tasks

### `Cypress`

Run Cypress end-to-end tests
#### Task options

| Property | Description                                                                                                                                                                                  | Type     |
| :------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| `url`    | URL to run Cypress against. If running in an environment such as a review or staging app build that has Tool Kit state with a URL for an app to run against, that will override this option. | `string` |

_All properties are optional._
<!-- end autogenerated docs -->
