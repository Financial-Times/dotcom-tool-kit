# @dotcom-tool-kit/serverless

Tool Kit plugin to manage Lambdas with [AWS serverless](https://www.serverless.com/framework/docs/getting-started/).

This plugin will be installed as a dependency of the [backend-serverless-app](https://github.com/Financial-Times/dotcom-tool-kit/tree/main/plugins/backend-serverless-app) plugin, which we recommend using instead of installing this plugin directly. That plugin will install additional plugins that will be useful or most Customer Products projects at the FT.

## Installation & usage

With Tool Kit [already set up](https://github.com/financial-times/dotcom-tool-kit#installing-and-using-tool-kit), install this plugin as a dev dependency:

```sh
npm install --save-dev @dotcom-tool-kit/serverless
```

And add it to your repo's `.toolkitrc.yml`:

```yml
plugins:
  - '@dotcom-tool-kit/serverless'
```

<!-- begin autogenerated docs -->
## Tasks

### `ServerlessRun`

Run serverless functions locally
#### Task options

| Property     | Description                                                                                                                                                                                                                                              | Type            | Default            |
| :----------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------- | :----------------- |
| `ports`      | ports to try to bind to for this application                                                                                                                                                                                                             | `Array<number>` | `[3001,3002,3003]` |
| `useDoppler` | run the application with environment variables from Doppler                                                                                                                                                                                              | `boolean`       | `true`             |
| `background` | run the `serverless oflfine` process in the background, i.e. don't wait for it to exit before continuing to other Tool Kit tasks. set to `false` to wait for the process to exit, useful for running [multiple Tool Kit tasks in parallel](../parallel). | `boolean`       | `true`             |

_All properties are optional._

### `ServerlessDeploy`

Deploy a serverless function

### `ServerlessProvision`

Provision a review serverless function

### `ServerlessTeardown`

Tear down existing serverless functions


## Plugin-wide options

### `@dotcom-tool-kit/serverless`

| Property                | Description                                                                                                                                                                                                                                          | Type            | Default         |
| :---------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------- | :-------------- |
| **`awsAccountId`** (\*) | the ID of the AWS account you wish to deploy to (account IDs can be found at the [FT login page](https://awslogin.in.ft.com/))                                                                                                                       | `string`        |                 |
| **`systemCode`** (\*)   | the system code for your app                                                                                                                                                                                                                         | `string`        |                 |
| `regions`               | an array of AWS regions you want to deploy to                                                                                                                                                                                                        | `Array<string>` | `["eu-west-1"]` |
| `configPath`            | path to your serverless config file. If this is not provided, Serverless defaults to `./serverless.yml` but [other config fomats are accepted](https://www.serverless.com/framework/docs/providers/aws/guide/intro#alternative-configuration-format) | `string`        |                 |

_(\*) Required._
<!-- end autogenerated docs -->
