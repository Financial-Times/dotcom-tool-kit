parameters:
  executor:
    default: default
    type: executor
  system-code:
    type: env_var_name
    default: CIRCLE_PROJECT_REPONAME
    description: >-
      The environment variable containing the system-code of the system being changed.
  environment:
    default: production
    description: The environment in which the system is being changed.
    type: string

executor: << parameters.executor >>

steps:
  - attach-workspace
  - run:
      name: Deploy to production
      command: npx dotcom-tool-kit deploy:production
  - change-api/change-log:
      environment: << parameters.environment >>
      system-code: << parameters.system-code >>
